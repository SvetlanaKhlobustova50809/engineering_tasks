@prefix : <http://kik.misis.ru/ontology/mpi/2024/Иванов-Петр/task3/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@base <http://kik.misis.ru/ontology/mpi/2024/Иванов-Петр/task3/> .

#################################################################
#    Rules
#################################################################

# Переменные для SWRL правил
:var_x rdf:type <http://www.w3.org/2003/11/swrl#Variable> .
:var_A rdf:type <http://www.w3.org/2003/11/swrl#Variable> .
:var_B rdf:type <http://www.w3.org/2003/11/swrl#Variable> .
:var_D rdf:type <http://www.w3.org/2003/11/swrl#Variable> .

# Правило валидации запроса к образовательному ресурсу
[ rdf:type <http://www.w3.org/2003/11/swrl#Imp> ;
  rdfs:label "Правило валидного запроса" ;
  rdfs:comment "Если запрос от студента обращается к ресурсу, который включен в программу обучения студента, то запрос является валидным" ;
  <http://www.w3.org/2003/11/swrl#body> [
      rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
      rdf:first [
          rdf:type <http://www.w3.org/2003/11/swrl#ClassAtom> ;
          <http://www.w3.org/2003/11/swrl#classPredicate> :ОбращениеКРесурсу ;
          <http://www.w3.org/2003/11/swrl#argument1> :var_x
      ] ;
      rdf:rest [
          rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
          rdf:first [
              rdf:type <http://www.w3.org/2003/11/swrl#IndividualPropertyAtom> ;
              <http://www.w3.org/2003/11/swrl#propertyPredicate> :имеет_автора ;
              <http://www.w3.org/2003/11/swrl#argument1> :var_x ;
              <http://www.w3.org/2003/11/swrl#argument2> :var_A
          ] ;
          rdf:rest [
              rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
              rdf:first [
                  rdf:type <http://www.w3.org/2003/11/swrl#ClassAtom> ;
                  <http://www.w3.org/2003/11/swrl#classPredicate> :Студент ;
                  <http://www.w3.org/2003/11/swrl#argument1> :var_A
              ] ;
              rdf:rest [
                  rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
                  rdf:first [
                      rdf:type <http://www.w3.org/2003/11/swrl#IndividualPropertyAtom> ;
                      <http://www.w3.org/2003/11/swrl#propertyPredicate> :обучается_на_программе ;
                      <http://www.w3.org/2003/11/swrl#argument1> :var_A ;
                      <http://www.w3.org/2003/11/swrl#argument2> :var_B
                  ] ;
                  rdf:rest [
                      rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
                      rdf:first [
                          rdf:type <http://www.w3.org/2003/11/swrl#ClassAtom> ;
                          <http://www.w3.org/2003/11/swrl#classPredicate> :ОбразовательнаяПрограмма ;
                          <http://www.w3.org/2003/11/swrl#argument1> :var_B
                      ] ;
                      rdf:rest [
                          rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
                          rdf:first [
                              rdf:type <http://www.w3.org/2003/11/swrl#IndividualPropertyAtom> ;
                              <http://www.w3.org/2003/11/swrl#propertyPredicate> :обращается_к ;
                              <http://www.w3.org/2003/11/swrl#argument1> :var_x ;
                              <http://www.w3.org/2003/11/swrl#argument2> :var_D
                          ] ;
                          rdf:rest [
                              rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
                              rdf:first [
                                  rdf:type <http://www.w3.org/2003/11/swrl#ClassAtom> ;
                                  <http://www.w3.org/2003/11/swrl#classPredicate> :ЭлектронныйОбразовательныйРесурс ;
                                  <http://www.w3.org/2003/11/swrl#argument1> :var_D
                              ] ;
                              rdf:rest [
                                  rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
                                  rdf:first [
                                      rdf:type <http://www.w3.org/2003/11/swrl#IndividualPropertyAtom> ;
                                      <http://www.w3.org/2003/11/swrl#propertyPredicate> :включает ;
                                      <http://www.w3.org/2003/11/swrl#argument1> :var_B ;
                                      <http://www.w3.org/2003/11/swrl#argument2> :var_D
                                  ] ;
                                  rdf:rest rdf:nil
                              ]
                          ]
                      ]
                  ]
              ]
          ]
      ]
  ] ;
  <http://www.w3.org/2003/11/swrl#head> [
      rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
      rdf:first [
          rdf:type <http://www.w3.org/2003/11/swrl#ClassAtom> ;
          <http://www.w3.org/2003/11/swrl#classPredicate> :ВалидныйЗапрос ;
          <http://www.w3.org/2003/11/swrl#argument1> :var_x
      ] ;
      rdf:rest rdf:nil
  ]
] .